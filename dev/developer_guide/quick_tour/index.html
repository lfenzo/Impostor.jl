<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick Tour (Start Here) · Impostor.jl</title><meta name="title" content="Quick Tour (Start Here) · Impostor.jl"/><meta property="og:title" content="Quick Tour (Start Here) · Impostor.jl"/><meta property="twitter:title" content="Quick Tour (Start Here) · Impostor.jl"/><meta name="description" content="Documentation for Impostor.jl."/><meta property="og:description" content="Documentation for Impostor.jl."/><meta property="twitter:description" content="Documentation for Impostor.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Impostor.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Providers</span><ul><li><a class="tocitem" href="../../providers/identity/">Identity</a></li><li><a class="tocitem" href="../../providers/finance/">Finance</a></li><li><a class="tocitem" href="../../providers/localization/">Localization</a></li></ul></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../../utilities/impostor_templates/">Impostor Templates</a></li><li><a class="tocitem" href="../../utilities/utility_functions/">Utility Functions</a></li><li><a class="tocitem" href="../../utilities/templatization/">Templatization</a></li></ul></li><li><span class="tocitem">Developer Guide</span><ul><li class="is-active"><a class="tocitem" href>Quick Tour (Start Here)</a><ul class="internal"><li><a class="tocitem" href="#Design-and-Structure"><span>Design and Structure</span></a></li><li><a class="tocitem" href="#Archive-Organization"><span>Archive Organization</span></a></li><li><a class="tocitem" href="#Adding-New-Data"><span>Adding New Data</span></a></li><li><a class="tocitem" href="#Adding-New-Functions"><span>Adding New Functions</span></a></li><li><a class="tocitem" href="#Testing-Philosophy"><span>Testing Philosophy</span></a></li></ul></li><li><a class="tocitem" href="../data_interface/">Data Interface</a></li></ul></li><li><a class="tocitem" href="../../api_reference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Guide</a></li><li class="is-active"><a href>Quick Tour (Start Here)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick Tour (Start Here)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lfenzo/Impostor.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lfenzo/Impostor.jl/blob/master/docs/src/developer_guide/quick_tour.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Tour"><a class="docs-heading-anchor" href="#Quick-Tour">Quick Tour</a><a id="Quick-Tour-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Tour" title="Permalink"></a></h1><p>This guide aims to provide a general overview of the internals of Impostor.jl. Some of the topics covered in this page are:</p><ul><li>High-level view of the functionality segregation.</li><li>Organization of data files used to generate the entries.</li><li>How to add new data to the package.</li><li>How to implement new generator-functions.</li></ul><h2 id="Design-and-Structure"><a class="docs-heading-anchor" href="#Design-and-Structure">Design and Structure</a><a id="Design-and-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Design-and-Structure" title="Permalink"></a></h2><p>Impostor doesn&#39;t magically generate valid names, street names, addreses or credit card numbers out of thin air, of course. Its generation process is based on the information contained in several <code>.csv</code> files structured according to which provider, content and locale each data refers to.</p><p>Roughly speaking, when a user calls the generator function <code>states([&quot;BRA&quot;, &quot;USA&quot;], 20; level = :country_code)</code> Impostor will internally fetch <code>.csv</code> data files with information about country codes and states, apply the appropriate filters and return correct number of generated entries respecting the restrictions imposed during the call of <code>states</code>.</p><p>The following figure depicts the data-flow process as a user requests the generation </p><div class="mermaid">graph LR
    subgraph Data Backend 
        direction LR
        A[.csv 1] --- B
        Z[.csv 2] --- B
        X[.csv 3] --- B
        Y[.csv 4] --- B
        W[.csv n] --- B[_load!]
        B --&gt; D[data_interface.jl]
    end
    subgraph Package Internals 
        direction LR
        G1[generator function 1]
        D --&gt; 
        G2[generator function 2]
        G3[generator function 3]
        G4[generator function n]
    end

    G2 --&gt; Ge[Generated Entries]</div><p>The steps performed in this generation process can be broken down in two main &quot;components&quot;:</p><ul><li><strong>Data Backend</strong>: responsable for <em>lazily loading</em> the contents, ensuring consistency between the requests and maintaining the structure of the data archive. It is also its responsability to verify the existance of the requested data files erroring when they are not available.</li><li><strong>Package Internals</strong>: serves as a client for the data backend, this component is responsible selecting the appropriate data files to be loaded and manipulate their contents to comply with the generator-function call restrictions when applicable (<em>e.g.</em> option-based or mask-based loading).</li></ul><h2 id="Archive-Organization"><a class="docs-heading-anchor" href="#Archive-Organization">Archive Organization</a><a id="Archive-Organization-1"></a><a class="docs-heading-anchor-permalink" href="#Archive-Organization" title="Permalink"></a></h2><p>The information contained in each of the <code>.csv</code> files is read into a <code>DataFrame</code> and stored in an internal structure <em>vaguely</em> called <code>DataContainer</code>. This <code>struct</code> encapsultes a list of currently selected locales for the Session Locale and a dictionary with sub-directories pointing to loaded DataFrames containing data consumed by the generator functions. The key-value structure used by this dictionary matches the organization of the <code>.csv</code> files under the <code>src/data/</code> directory as follows:</p><pre><code class="nohighlight hljs">src/data/
    &lt;provider&gt;/
        &lt;content&gt;/
            HEADER.txt
            en_US.csv
            pt_BR.csv
            ...
            en_UK.csv</code></pre><p>In the structure above:</p><ul><li><code>provider</code> encapsulates the associated <em>Provider</em>, <em>e.g.</em> Localization</li><li><code>content</code> stores the <code>.csv</code> files for a given <em>Content</em>, <em>e.g.</em> state codes. Each <code>.csv</code> content file is named after the locale it refers to.</li><li><code>HEADER.txt</code> is a text file storing exclusively names of columns for all files stored in the <code>src/data/&lt;provider&gt;/&lt;content&gt;/</code> directory, one column name per line. This file ensures column naming consistency across all locales and prevents individual files from needlessly repeating the same column names. For that reason, every <code>.csv</code> file <strong>must contain only the associated <em>data</em>, leaving <em>headers</em> for the respective <code>HEADER.txt</code> files</strong>.</li></ul><p>The interface between the data file structure shown above and the generator functions is stablished by the <a href="../data_interface/#Impostor._load!"><code>Impostor._load!</code></a> method, which serves as a single point of access to all information stored in the <code>src/data/</code> directory. When a generator-function internally calls</p><pre><code class="language-julia hljs">Impostor._load!(&quot;localization&quot;, &quot;state&quot;, &quot;en_US&quot;)</code></pre><p>the structured archive is checked for the existance of a <code>&quot;state&quot;</code> <em>content</em> in the <code>&quot;localization&quot;</code> <em>provider</em> associated to the United States english (<code>&quot;en_US&quot;</code>) <em>locale</em>. If such file is available, a <code>DataFrame</code> object is returned with the associated data for further manipulation. Since the column names for a given (<code>&quot;localization&quot;</code>, <code>&quot;state&quot;</code>) tuple are garanteed to be equal by design, multiple locales may be loaded at once:</p><pre><code class="language-julia hljs">Impostor._load!(&quot;localization&quot;, &quot;state&quot;, [&quot;en_US&quot;, &quot;pt_BR&quot;])</code></pre><div class="admonition is-info"><header class="admonition-header">Note on Implementation</header><div class="admonition-body"><p>The <a href="../data_interface/#Impostor._load!"><code>Impostor._load!</code></a> is designed in such way that <strong>the DataFrames loaded in each interaction with the archive are memoized</strong> to prevent reading the same information more than once per session. This functionality is aided by the functions present in the <a href="../../utilities/utility_functions/">Utility Function</a> page.</p></div></div><p>Once loaded, the data is manipulated according to the needs of the particular generator-function and always returned though the <a href="../../utilities/utility_functions/#Impostor.coerse_string_type"><code>Impostor.coerse_string_type</code></a> function which output formatting consistency.</p><h2 id="Adding-New-Data"><a class="docs-heading-anchor" href="#Adding-New-Data">Adding New Data</a><a id="Adding-New-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-New-Data" title="Permalink"></a></h2><p>In order to add new data files, contents or providers, carefully follow the same directory structure described in the previous section paying attention to the format of the <code>HEADER.txt</code> file. Some of the scenarios you will find while adding new data to the archive are shown below:</p><ul><li><strong>Incrementing existing locale files</strong>: corresponds to the simplest case, just add new rows to the respective <code>.csv</code> file. Typically, to ease navigation for users adding new data, the <code>.csv</code> are usually sorted by some of its columns, make your changes so that this property remains valid in the modified file.</li><li><strong>Adding new contents or providers</strong>: in both cases the creation of a new directory/set of directories is needed. Although this my be slightly subjective, try to do it so that the new set of directories resambles the current organization structure in <code>data/</code> (when in doubt reach out via GitHub so we can discuss the best organization for the files).<ul><li>Make sure that a set of unit tests exist for the new content in order to ensure its consistency, place the implementation under the <code>tests/data_integrity/</code> directory in a file called <code>test_&lt;your provider&gt;.jl</code></li><li>If your data requires any kind of restriction (<em>e.g.</em> a certain column may only contain a restricted set of values), register such restrictions in the <code>src/relation_restrictions.jl</code> file.</li></ul></li></ul><h2 id="Adding-New-Functions"><a class="docs-heading-anchor" href="#Adding-New-Functions">Adding New Functions</a><a id="Adding-New-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-New-Functions" title="Permalink"></a></h2><p>Some guide-lines on adding new generator-functions are:</p><ol><li>Make sure that that contents required for the new generator-function are available under the data archive in <code>src/data/</code>. If not, then proceed to the previous section on adding new data.</li><li>Use <em>exclusively</em> the <a href="../data_interface/#Impostor._load!"><code>Impostor._load!</code></a> function to interact with the data archive. In order to manipulate the dataframe(s) according to your needs, the functions exported by <a href="https://dataframes.juliadata.org/stable/lib/functions/">DataFrames.jl</a> should suffice most use cases. If you need other package(s) to manipulate the dataframes in order to get the desired output, file an issue explaining the situation and we will discuss the addition of a new dependency.</li><li>Add the new generator-function to the <code>export</code> list in the <code>src/Impostor.jl</code> in the appropriate Provider grouping. Make sure to add it in alphabetical order in each group.</li><li>Add docstrings with examples, when possible/applicable.</li></ol><h2 id="Testing-Philosophy"><a class="docs-heading-anchor" href="#Testing-Philosophy">Testing Philosophy</a><a id="Testing-Philosophy-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-Philosophy" title="Permalink"></a></h2><p>Tests in Impostor are split in two categories: <em>implementation correctness</em> tests (the usual case for virtually all unit-tested codebases); and <em>data integrity</em> tests which ensure that properties of  data in each <code>.csv</code> are respected for each locale, content and provider. In this context, the testing philosophy used by this package is that:</p><blockquote><p>If the contents of datafiles are exhaustively tested for consistency, then testing generator-functions becames a matter of ensuring output formatting correctness.</p></blockquote><p>In this context, <em>testing for consistency</em> means that some set of validations is performed upon the files in <code>src/data/</code> expecting to verify if the newly added data produces any unexpected behavior on the generator-function side of things.</p><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../utilities/templatization/">« Templatization</a><a class="docs-footer-nextpage" href="../data_interface/">Data Interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 11 April 2024 22:00">Thursday 11 April 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
